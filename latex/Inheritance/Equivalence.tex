\begin{AgdaAlign}
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}%
\>[31]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[63]\AgdaComment{--\ natural\ numbers}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe.Base}%
\>[31]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[43]\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaDatatype{\AgdaUnderscore{}+?}\AgdaSymbol{;}%
\>[63]\AgdaComment{--\ A\ +?\ is\ disjoint\ union\ of\ A\ and\ \{??\}}\<%
\\
%
\>[43]\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{??}\AgdaSymbol{;}%
\>[63]\AgdaComment{--\ ??\ represents\ absence\ of\ an\ A\ value}\<%
\\
%
\>[43]\AgdaFunction{maybe′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{[\AgdaUnderscore{},\AgdaUnderscore{}]?}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[63]\AgdaComment{--\ [\ f\ ,\ x\ ]?\ is\ case\ analysis\ on\ A\ +?}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}%
\>[31]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}%
\>[63]\AgdaComment{--\ A\ ×\ B\ is\ Cartesian\ product,\ \AgdaUnderscore{},\AgdaUnderscore{}\ is\ pairing}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}%
\>[31]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Inverse}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↔\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}%
\>[63]\AgdaComment{--\ A\ ↔\ B\ is\ isomorphism\ between\ A\ and\ B}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Inverse}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{\}\}}%
\>[31]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{from}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{inverseˡ}\AgdaSymbol{)}%
\>[63]\AgdaComment{--\ to\ :\ A\ →\ B;\ from\ :\ B\ →\ A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Inheritance.Equivalence}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Domain}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaPrimitive{Set₁}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ Domain\ is\ a\ type\ of\ cpo}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨\AgdaUnderscore{}⟩}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ ⟨\ D\ ⟩\ is\ the\ type\ of\ elements\ of\ D}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⊑\AgdaUnderscore{}}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ x\ ⊑\ y\ is\ the\ partial\ order\ of\ D}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ ⊥\ is\ the\ least\ element\ of\ D}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{lub}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{δ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ least\ upper\ bound\ of\ chains\ δ}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{fix}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ fix\ f\ is\ the\ least\ fixed-point\ of\ f}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{?⊥}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ ⊥\ is\ the\ only\ element\ of\ ?⊥}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+⊥\AgdaUnderscore{}}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ D\ +⊥\ E\ is\ the\ separated\ sum\ of\ D\ and\ E}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ inl\ injects\ elements\ of\ D\ into\ D\ +⊥\ E}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaComment{--\ inr\ injects\ elements\ of\ E\ into\ D\ +⊥\ E}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[\AgdaUnderscore{},\AgdaUnderscore{}]⊥}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[62]\AgdaComment{--\ [\ f\ ,\ g\ ]⊥\ is\ case\ analysis\ on\ D\ +⊥\ E}\<%
\\
\>[17][@{}l@{\AgdaIndent{0}}]%
\>[19]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Instance}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[26]\AgdaComment{--\ objects}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Name}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[26]\AgdaComment{--\ class\ names}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[26]\AgdaComment{--\ method\ names}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Primitive}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[26]\AgdaComment{--\ function\ names}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Number}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ the\ domain\ of\ numbers\ is\ unconstrained}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Value}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ value\ is\ (isomorphic\ to)\ a\ behavior\ or\ a\ number}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Behavior}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ behaviour\ maps\ a\ method\ name\ to\ a\ fun,\ or\ to\ the\ only\ element\ of\ ?⊥}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Fun}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ fun\ maps\ an\ argument\ value\ to\ a\ value\ (possibly\ ⊥)}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵛ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{Number}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵇ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{?⊥}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᶠ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦\AgdaUnderscore{}⟧}}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Primitive}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Inheritance.Definitions}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{fix}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{?⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+⊥\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[\AgdaUnderscore{},\AgdaUnderscore{}]⊥}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Name}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Primitive}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Number}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵛ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵇ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᶠ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{class}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[45]\AgdaComment{--\ "class\ ρ"\ is\ the\ class\ of\ an\ object}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{methods′}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Exp}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+?}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[45]\AgdaComment{--\ "methods′\ κ\ m"\ is\ the\ method\ named\ m\ in\ κ}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Semantics}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{class}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{methods′}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\end{code}

\subsection{Intermediate Semantics}

The intermediate semantics of method expressions given in CP89
is a step-indexed variant of the method lookup semantics.
It takes an extra argument $n$ ranging over \textbf{Nat} (the set of natural numbers),
which acts as sufficient `fuel' for up to $n-1$ uses of \textbf{self}:
when $n$ is zero, the intermediate semantics is the undefined behavior ($\bot$).
One of the lemmas proved in CP89 shows that the intermediate semantics at $n$
corresponds to the $n$th approximation to the denotational semantics.

The functions used to specify the intermediate semantics are mutually recursive,
in the same way as in the method lookup semantics.
Here, however, the finiteness of the fuel argument ensures that the functions are total,
so they can be defined in Agda without an explicit least fixed-point:
%
\begin{code}%
%
\>[2]\AgdaFunction{send′}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[2]\AgdaFunction{lookup′}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{do′\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧}}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Exp}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaFunction{lookup′}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{child}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{c}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaCatchallClause{\AgdaSymbol{)}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[373I]\AgdaOperator{\AgdaFunction{[}}%
\>[43]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
%
\>[43]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[373I]%
\>[40]\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaFunction{lookup′}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{origin}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\end{code}
%
Cases of Agda definitions are sequential:
below, putting a case for \AgdaInductiveConstructor{zero}
before the corresponding case for \AgdaBound{n}
implies that \AgdaBound{n} is positive in the latter.
%
\begin{code}%
%
\>[2]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[15]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}%
\>[31]\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}%
\>[15]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}%
\>[31]\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}%
\>[15]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{super}}%
\>[31]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{child}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{c}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaCatchallClause{\AgdaSymbol{)}}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}%
\>[15]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{super}}%
\>[31]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{origin}}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}%
\>[15]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{arg}}%
\>[31]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{α}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}%
\>[15]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{call}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₁}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{m}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₂}}%
\>[31]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[470I]\AgdaOperator{\AgdaBound{[}}%
\>[471I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[475I]\AgdaOperator{\AgdaBound{[}}%
\>[476I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\<%
\\
\>[.][@{}l@{}]\<[476I]%
\>[73]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[82]\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[475I]%
\>[71]\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\<%
\\
\>[.][@{}l@{}]\<[471I]%
\>[63]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[470I]%
\>[61]\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}%
\>[15]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{appl}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{f}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₁}}%
\>[31]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}%
\>[48]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\<%
\end{code}
%The proofs of the lemmas use the following additional modules from the standard library:
%
\begin{code}[hide]%
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}%
\>[33]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq.≡-Reasoning}%
\>[33]\AgdaComment{--\ using\ (begin\AgdaUnderscore{};\ \AgdaUnderscore{}≡⟨⟩\AgdaUnderscore{};\ \AgdaUnderscore{}≡⟨\AgdaUnderscore{}⟩\AgdaUnderscore{};\ \AgdaUnderscore{}∎)}\<%
\\
%
\>[2]\AgdaComment{--\ TODO:\ The\ module\ Eq.≡-Reasoning\ doesn't\ export\ the\ following:\ \AgdaUnderscore{}≡⟨⟩\AgdaUnderscore{}\ \AgdaUnderscore{}≡⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Bundles}%
\>[39]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaRecord{Poset}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Reasoning.PartialOrder}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{⊑-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Axiom.Extensionality.Propositional}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Extensionality}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Level}%
\>[33]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{suc}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Extensionality}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaComment{--\ \AgdaUnderscore{}⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}\ :\ \{D\ :\ Domain\}\ →\ (x\ :\ ⟨\ D\ ⟩\ )\ →\ \{y\ z\ :\ ⟨\ D\ ⟩\ \}\ →\ x\ ⊑\ y\ →\ y\ ⊑\ z\ →\ x\ ⊑\ z}\<%
\\
%
\>[4]\AgdaComment{--\ x\ ⊑⟨\ p\ ⟩\ q\ =\ ⊑-is-transitive\ p\ q}\<%
\\
%
\>[4]\AgdaComment{--\ \AgdaUnderscore{}⊑⟨⟩\AgdaUnderscore{}\ :\ \{D\ :\ Domain\}\ →\ (x\ :\ ⟨\ D\ ⟩\ )\ →\ \{y\ :\ ⟨\ D\ ⟩\ \}\ →\ x\ ⊑\ y\ →\ x\ ⊑\ y}\<%
\\
%
\>[4]\AgdaComment{--\ x\ ⊑⟨⟩\ q\ =\ x\ ⊑⟨\ ⊑-is-reflexive\ ⟩\ q}\<%
\\
%
\>[4]\AgdaComment{--\ infixr\ 2\ \AgdaUnderscore{}⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}\<%
\\
%
\>[4]\AgdaComment{--\ infixr\ 2\ \AgdaUnderscore{}⊑⟨⟩\AgdaUnderscore{}}\<%
\\
\>[0]\<%
\end{code}

\subsection{Proofs of Lemmas in Agda}

Lemma~1 establishes a significant fact about the relationship
between the denotational semantics and the intermediate semantics of method systems.
Its Agda proof exhibits the equational reasoning steps of the original proofs in CP89.
This checks the correctness not only of the stated result, but also of the steps themselves.

The Agda standard library defines notation for equational reasoning:
\AgdaRef{x ≡ y} asserts the equality of \AgdaRef{x} and \AgdaRef{y};
\AgdaRef{begin} starts a proof;
\AgdaRef{≡⟨⟩} adds a step that Agda can check automatically;
\AgdaRef{≡⟨ t ⟩} adds a step with an explicit proof term \AgdaRef{t};
and \AgdaRef{∎} concludes a proof.

The proof of this lemma is a straightforward structural induction.
The restriction to the class \AgdaRef{child c κ} ensures that it is not the root class;
in CP89, the use of $\textit{parent}(κ)$ as an argument of type \textbf{Class}
in the statement of Lemma~1 leaves this restriction implicit.
%
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\end{code}
%
The equational reasoning proof steps in the inductive case for calling a method
are quite complicated in Agda.
This is mainly due to the case analysis required in the semantics of method calls
to make the semantics type-correct
(these cases are left implicit in CP89).
Using rewrite below concisely hides the complicated terms needed for the intermediate proof steps.
%
\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{call}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
%
The inductive case for applying a primitive function is relatively simple,
and concludes the proof of Lemma 1.
%
\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}%
\>[816I]\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[816I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaKeyword{where}%
\>[851I]\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[851I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaField{to}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\<%
\end{code}
\end{AgdaAlign}
%
The proofs of the remaining lemmas are available in the accompanying auxiliary material:
%
\newcommand{\LemmaTwo}{
\subsection*{Lemma 2}

The proof of this lemma exhibits the same steps of equational reasoning
as the corresponding proof in CP89.%
\footnote{As a novice user of Agda, I found it difficult to construct the terms
representing the context for some of the steps;
Casper Bach Poulsen provided the two largest ones.}
%
\begin{code}%
%
\>[4]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}%
\>[875I]\AgdaBound{[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaComment{--\ [,]⊥-elim\ eliminates\ an\ application\ of\ [\ f\ ,\ g\ ]⊥}\<%
\\
\>[875I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+?}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{where}\<%
\end{code}
}%
\begin{code}%
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaTwoProof}{
\begin{code}%
%
\>[6]\AgdaComment{--\ lemma-2\ :\ ∀\ κ\ n\ ρ\ →\ gen\ κ\ (send‵′\ n\ ρ)\ ≡\ lookup′\ (suc\ n)\ κ\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{⊥}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ gen}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⍄}}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ \AgdaUnderscore{}⍄\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-lemma-2}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaBound{π}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ \AgdaUnderscore{}⊕\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ wrap}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\<%
\\
%
\>[14]\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-to∘from-inverse}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-[,]⊥-elim}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1171I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1171I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ π}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1199I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1199I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-lemma-1}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1236I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1236I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ lookup′}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[8]\AgdaKeyword{where}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{π′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaComment{--\ TODO:\ how\ to\ refer\ to\ π\ instead\ of\ π′?}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{lookup′}\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{use-lemma-2}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaFunction{use-to∘from-inverse}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaFunction{π′}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{X}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inverseˡ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaFunction{use-[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaBound{[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{Exp}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{π′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{z}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\})}\<%
\\
%
\>[10]\AgdaFunction{use-lemma-1}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))))}\<%
\end{code}
}%
\newcommand{\LemmaThree}{
\subsection*{Lemma 3}
}%
\begin{code}%
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{g}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaThreeProof}{
\begin{code}%
%
\>[6]\AgdaComment{--\ lemma-3\ :\ ∀\ n\ ρ\ →\ iter\ n\ (gen\ (class\ ρ))\ ≡\ send‵′\ n\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{⊥}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}%
\>[25]\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[8]\AgdaKeyword{where}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\end{code}
}%
\newcommand{\LemmaFour}{
\subsection*{Lemma 4}

\begin{code}%
%
\>[6]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[60]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[60]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊑-is-transitive}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[60]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}%
\>[1545I]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[.][@{}l@{}]\<[1545I]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}%
\>[1575I]\AgdaBound{is-assumed-monotone-2}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[.][@{}l@{}]\<[1575I]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(\{}\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{where}\<%
\\
%
\>[8]\AgdaComment{--\ is-chain\ :\ \{D\ :\ Domain\}\ →\ (δ\ :\ ℕ\ →\ ⟨\ D\ ⟩)\ →\ Set}\<%
\\
%
\>[8]\AgdaComment{--\ is-chain\ δ\ =\ ∀\ n\ →\ (δ\ n)\ ⊑\ (δ\ (suc\ n))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\<%
\\
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-send′}%
\>[25]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaFourSendProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-send‵′\ :\ ∀\ n\ ρ\ →\ send‵′\ n\ ρ\ ⊑\ send‵′\ (suc\ n)\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-lookup′}%
\>[25]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaFourLookupProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-lookup′\ :\ ∀\ n\ κ\ ρ\ →\ lookup′\ n\ κ\ ρ\ ⊑\ lookup′\ (suc\ n)\ κ\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\<%
\\
%
\>[8]\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-do′}%
\>[25]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\end{code}
%
\newcommand{\LemmaFourDoProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-do′\ :\ ∀\ n\ e\ ρ\ c\ κ\ →\ do′\ (suc\ n)\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)\ ⊑\ do′\ (suc\ (suc\ n))\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-do′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}%
\>[45]\AgdaComment{--\ do′\ (suc\ n)\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)\ ⊑\ do′\ (suc\ (suc\ n))\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}%
\>[45]\AgdaComment{--\ eval⟦\ e\ ⟧\ (send‵′\ (suc\ n)\ ρ)\ (lookup′\ (suc\ (suc\ n))\ \ κ\ ρ)}\<%
\\
%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}%
\>[45]\AgdaComment{--\ eval⟦\ e\ ⟧\ (send‵′\ n\ \ \ \ \ \ \ ρ)\ (lookup′\ (suc\ n)\ \ \ \ \ \ \ \ κ\ ρ)}\<%
\\
%
\>[10]\AgdaSymbol{=}%
\>[1785I]\AgdaBound{⊑-is-transitive}\<%
\\
\>[1785I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaBound{is-assumed-monotone-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[14]\AgdaSymbol{(}\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\end{code}
}%
%  In poset reasoning style, it would be:
%
%  begin
%    do′ (suc n) ⟦ e ⟧ ρ (child c κ)
%  ≡⟨ lemma-1 (suc n) e ρ c κ ⟩
%    eval⟦ e ⟧ (send′ n ρ)       (lookup′ (suc n) κ ρ)
%  ⊑⟨ is-assumed-monotone (eval⟦ e ⟧) (send′ n ρ) (send′ (suc n) ρ)
%       (lemma-4-send′ n ρ) ⟩
%    eval⟦ e ⟧ (send′ (suc n) ρ) (lookup′ (suc n) κ ρ)
%  ⊑⟨ is-assumed-monotone (eval⟦ e ⟧ (send′ (suc n) ρ)) (lookup′ (suc n) κ ρ) (lookup′ (suc (suc n)) κ ρ)
%       (lemma-4-lookup′ (suc n) κ ρ) ⟩
%    eval⟦ e ⟧ (send′ (suc n) ρ) (lookup′ (suc (suc n)) κ ρ)
%  ≡⟨ sym (lemma-1 (suc (suc n)) e ρ c κ) ⟩
%    do′ (suc (suc n)) ⟦ e ⟧ ρ (child c κ)
%  ∎

\subsection{Remaining Results}

When Agda proofs of the remaining propositions and correctness theorem from CP89
have been developed, they are to be made available on GitHub at
\url{https://github.com/pdmosses/jensfest-agda}.

\begin{code}[hide]%
%
\>[8]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaBound{Gᵍ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵍ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Gᵍ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↔}}\AgdaSpace{}%
\AgdaFunction{Dᵍ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}\<%
\end{code}
\begin{code}%
%
\>[10]\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[10]\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{lub}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[10]\AgdaFunction{proposition-1}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{proposition-2}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{proposition-3}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{theorem-1}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
\begin{code}[hide]%
%
\>[10]\AgdaFunction{proposition-1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{proposition-2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{proposition-3}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{theorem-1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\end{code}
