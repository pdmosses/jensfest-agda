\subsection{Intermediate Semantics}
%
\begin{AgdaAlign}
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[34]\AgdaComment{--\ ℕ\ \ \ \ \ \ \ \ \ \ \ \ \ \textasciitilde{}\ Nat}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe.Base}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[14I]\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaDatatype{\AgdaUnderscore{}+?}\AgdaSymbol{;}%
\>[34]\AgdaComment{--\ A\ +?\ \ \ \ \ \ \ \ \ \textasciitilde{}\ A\ +\ ?}\<%
\\
\>[.][@{}l@{}]\<[14I]%
\>[13]\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{??}\AgdaSymbol{;}%
\>[34]\AgdaComment{--\ ??\ \ \ \ \ \ \ \ \ \ \ \ \ \textasciitilde{}\ ⊥?}\<%
\\
%
\>[13]\AgdaFunction{maybe′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{[\AgdaUnderscore{},\AgdaUnderscore{}]?}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[34]\AgdaComment{--\ [\ f\ ,\ x\ ]?\ \ \ \ \textasciitilde{}\ [f,\ λ⊥?.x]}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}%
\>[34]\AgdaComment{--\ A\ ×\ B\ \ \ \ \ \ \ \ \textasciitilde{}\ A\ ×\ B}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Inverse}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↔\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}%
\>[34]\AgdaComment{--\ A\ ↔\ B\ \ \ \ \ \ \textasciitilde{}\ implicit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Inverse}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{from}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{inverseˡ}\AgdaSymbol{)}%
\>[34]\AgdaComment{--\ to\ from\ \ \ \ \ \textasciitilde{}\ implicit}\<%
\end{code}%
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Inheritance.Equivalence}\<%
\end{code}%
%
The imports and parameters of this module are the same as those of
\AgdaCode[\AgdaModule{Inheritance.Definitions}]
{Inheritance.Definitions},
and elided here.
%
\newcommand{\EquivalenceParameters}{
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Domain}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaPrimitive{Set₁}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨\AgdaUnderscore{}⟩}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⊑\AgdaUnderscore{}}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{fix}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{?⊥}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+⊥\AgdaUnderscore{}}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[\AgdaUnderscore{},\AgdaUnderscore{}]⊥}}%
\>[14]\AgdaSymbol{:}%
\>[17]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[17][@{}l@{\AgdaIndent{0}}]%
\>[19]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[19]\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Instance}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ objects}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Name}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ class\ names}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ method\ names}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Primitive}%
\>[17]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ function\ names}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Number}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ unspecified}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Value}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ value\ is\ a\ behavior\ or\ a\ number}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Behavior}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ behavior\ maps\ keys\ to\ funs}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Fun}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[32]\AgdaComment{--\ a\ fun\ maps\ values\ to\ values}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵛ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{Number}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵇ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{+⊥}}\AgdaSpace{}%
\AgdaBound{?⊥}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᶠ}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}%
\>[32]\AgdaOperator{\AgdaFunction{↔}}%
\>[35]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[62]\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦\AgdaUnderscore{}⟧}}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Primitive}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\end{code}}%
\begin{code}%
\>[0][@{}l@{\AgdaIndent{2}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Inheritance.Definitions}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{fix}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{?⊥}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+⊥\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[\AgdaUnderscore{},\AgdaUnderscore{}]⊥}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Name}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Primitive}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Number}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Value}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵛ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵇ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᶠ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{class}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{methods′}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Key}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Exp}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+?}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Semantics}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{class}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{methods′}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\end{code}
%
The intermediate semantics of method expressions given in CP89
is a step-indexed variant of the method lookup semantics.
It takes an extra argument $n$ ranging over \textbf{Nat} (the set of natural numbers),
which acts as sufficient `fuel' for up to $n-1$ uses of \textbf{self}:
when $n$ is zero, the intermediate semantics is the undefined behavior ($\bot$).
One of the lemmas proved in CP89 shows that the intermediate semantics at $n$
corresponds to the $n$th approximation to the denotational semantics.

The functions used to specify the intermediate semantics are mutually recursive,
in the same way as in the method lookup semantics.
Here, however, the finiteness of the fuel argument ensures that the functions are total,
so they can be defined in Agda without an explicit least fixed-point:
%
\begin{code}%
%
\>[2]\AgdaFunction{send′}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[2]\AgdaFunction{lookup′}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{do′\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧}}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Exp}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Class}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Fun}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaFunction{lookup′}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{child}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{c}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaCatchallClause{\AgdaSymbol{)}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[356I]\AgdaOperator{\AgdaFunction{[}}%
\>[357I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[357I]%
\>[17]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[356I]%
\>[15]\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaFunction{lookup′}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{origin}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\end{code}
%
Cases of Agda definitions are sequential:
putting a case for \AgdaCode[\AgdaInductiveConstructor{zero}]
{zero}
before the corresponding case for \AgdaCode[\AgdaBound{n}]
{n}
implies that \AgdaCode[\AgdaBound{n}]
{n} is positive in the latter.
%
\begin{code}%
%
\>[2]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[15]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}%
\>[23]\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}%
\>[15]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}%
\>[23]\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{super}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{child}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{c}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaCatchallClause{\AgdaSymbol{)}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{super}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{origin}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{arg}}%
\>[16]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{α}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{call}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₁}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{m}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₂}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[466I]\AgdaOperator{\AgdaBound{[}}%
\>[467I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[471I]\AgdaOperator{\AgdaBound{[}}%
\>[472I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\<%
\\
\>[.][@{}l@{}]\<[472I]%
\>[27]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[36]\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[471I]%
\>[25]\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\<%
\\
\>[.][@{}l@{}]\<[467I]%
\>[17]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[466I]%
\>[15]\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{do′}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟦}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaInductiveConstructor{appl}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{f}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{e₁}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaOperator{\AgdaFunction{⟧}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{ρ}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{κ}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\<%
\end{code}

\subsection{Proofs of Lemmas in Agda}

The proofs of the lemmas use the following additional modules from the standard library:
%
%  -- TODO: use Reasoning.PartialOrder instead of ≡-Reasoning
%  -- open import Relation.Binary.Core using (Rel; _⇒_)
%  -- open import Relation.Binary.Bundles using (Poset; Setoid)
%  -- open import Relation.Binary.Definitions using (Transitive; Antisymmetric)
%  -- import Relation.Binary.Reasoning.PartialOrder as ⊑-Reasoning renaming (_≤_ to _⊑_)
%  -- open ⊑-Reasoning P -- requires ⟨ D ⟩ to be viewed as P.Carrier where P : Poset _ _ _
%
\begin{code}%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality.Core}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality.Properties}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Reasoning.Syntax}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{≡-Reasoning}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Axiom.Extensionality.Propositional}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Extensionality}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Level}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{suc}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Extensionality}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\end{code}

Lemma~1 establishes a significant fact about the relationship
between the denotational semantics and the intermediate semantics of method systems.
Its Agda proof exhibits the equational reasoning steps of the original proof in CP89.
This checks the correctness not only of the stated result, but also of the steps themselves.

The Agda standard library defines the following notation for equational reasoning:
\begin{itemize}
\item \AgdaCode[\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}]
{x ≡ y} asserts the equality of \AgdaCode[\AgdaBound{x}]
{x} and \AgdaCode[\AgdaBound{y}]
{y};
\item \AgdaCode[\AgdaOperator{\AgdaFunction{begin}}]
{begin} starts a proof;
\item \AgdaCode[\AgdaFunction{≡⟨⟩}]
{≡⟨⟩} adds a step that Agda can check automatically;
\item \AgdaCode[\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaFunction{⟩}]
{≡⟨ t ⟩} adds a step with an explicit proof term \AgdaCode[\AgdaBound{t}]
{t};
and
\item \AgdaCode[\AgdaOperator{\AgdaFunction{∎}}]
{∎} concludes a proof.
\end{itemize}

\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\end{code}
%
The restriction to the class \AgdaCode[\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}]
{child c κ} ensures that it is not the root class;
in CP89, the use of $\textit{parent}(κ)$ as an argument of type \textbf{Class}
in the statement of Lemma~1 leaves this restriction implicit.

The proof of this lemma is a straightforward structural induction:

\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{self}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c′}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{super}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}%
\>[13]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}%
\>[13]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{arg}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\end{code}
%
The equational reasoning proof steps in the inductive case for calling a method
are quite complicated in Agda.
This is mainly due to the case analysis required in the semantics of method calls
to make the semantics type-correct
(these cases are left implicit in CP89).
The use of \AgdaCode[\AgdaKeyword{rewrite}]
{rewrite} below succinctly verifies the correctness of the case analysis:
%
\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{call}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₂}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
%
The inductive case for applying a primitive function is relatively simple,
and concludes the proof of Lemma 1.
%
\begin{code}%
%
\>[4]\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}%
\>[781I]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[781I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}%
\>[801I]\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[801I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{appl}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaKeyword{where}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaBound{apply⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaField{to}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{α}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e₁}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\<%
\end{code}
\end{AgdaAlign}%
%
The Agda proofs of the remaining lemmas are available in the accompanying auxiliary material.
%
\newcommand{\LemmaTwo}{
\subsection*{Lemma 2}

The proof of this lemma exhibits the same steps of equational reasoning
as the corresponding proof in CP89.%
\footnote{As a novice user of Agda, I found it difficult to construct the terms
representing the context for some of the steps;
Casper Bach Poulsen provided the two largest ones.}
%
\begin{code}%
%
\>[4]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}%
\>[853I]\AgdaBound{[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaComment{--\ [,]⊥-elim\ eliminates\ an\ application\ of\ [\ f\ ,\ g\ ]⊥}\<%
\\
\>[853I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+?}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{where}\<%
\end{code}
}%
\begin{code}%
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaTwoProof}{
\begin{code}%
%
\>[6]\AgdaComment{--\ lemma-2\ :\ ∀\ κ\ n\ ρ\ →\ gen\ κ\ (send‵′\ n\ ρ)\ ≡\ lookup′\ (suc\ n)\ κ\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{⊥}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{origin}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ gen}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⍄}}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ \AgdaUnderscore{}⍄\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-lemma-2}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaBound{π}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ \AgdaUnderscore{}⊕\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ wrap}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\<%
\\
%
\>[14]\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-to∘from-inverse}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaBound{φ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{inr}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-[,]⊥-elim}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1149I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1149I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaBound{π}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ π}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1177I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1177I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-lemma-1}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{[}}%
\>[1214I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\<%
\\
\>[.][@{}l@{}]\<[1214I]%
\>[14]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\AgdaSpace{}%
\AgdaComment{--\ use\ definition\ of\ lookup′}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[8]\AgdaKeyword{where}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{π′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaComment{--\ TODO:\ how\ to\ refer\ to\ π\ instead\ of\ π′?}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{lookup′}\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{use-lemma-2}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{wrap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊕}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaFunction{use-to∘from-inverse}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{[}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaFunction{π′}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{]⊥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{X}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inverseˡ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaFunction{use-[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaBound{[,]⊥-elim}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{Exp}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{π′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{z}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\})}\<%
\\
%
\>[10]\AgdaFunction{use-lemma-1}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]?}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{methods}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaBound{ext}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{inl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))))}\<%
\end{code}
}%
\newcommand{\LemmaThree}{
\subsection*{Lemma 3}
}%
\begin{code}%
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{g}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥}\<%
\\
%
\>[6]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaThreeProof}{
\begin{code}%
%
\>[6]\AgdaComment{--\ lemma-3\ :\ ∀\ n\ ρ\ →\ iter\ n\ (gen\ (class\ ρ))\ ≡\ send‵′\ n\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{⊥}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}%
\>[25]\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaFunction{≡⟨⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[8]\AgdaKeyword{where}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{use-induction}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\end{code}
}%
\newcommand{\LemmaFour}{
\subsection*{Lemma 4}

\begin{code}%
%
\>[6]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[60]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{⊥}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[62]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{⊑-is-transitive}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}%
\>[60]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}%
\>[1528I]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[.][@{}l@{}]\<[1528I]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}%
\>[1558I]\AgdaBound{is-assumed-monotone-2}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[.][@{}l@{}]\<[1558I]%
\>[12]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(\{}\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{where}\<%
\\
%
\>[8]\AgdaComment{--\ }\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{begin-⊑\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{begin-⊑}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎-⊑}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[8]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎-⊑}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\<%
\\
%
\>[8]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊑⟨}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊑-is-transitive}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≡⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\<%
\\
%
\>[8]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≡⊑⟨}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[24]\AgdaBound{⊑-is-transitive}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑≡⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{z}\<%
\\
%
\>[8]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊑≡⟨}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[24]\AgdaBound{⊑-is-transitive}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑⟨⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\>[8]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊑⟨⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊑⟨}}\AgdaSpace{}%
\AgdaBound{⊑-is-reflexive}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[8]\AgdaKeyword{infix}%
\>[15]\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin-⊑\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑≡⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≡⊑⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊑⟨⟩\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaKeyword{infix}%
\>[15]\AgdaNumber{3}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎-⊑}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaComment{--\ is-chain\ :\ \{D\ :\ Domain\}\ →\ (δ\ :\ ℕ\ →\ ⟨\ D\ ⟩)\ →\ Set}\<%
\\
%
\>[8]\AgdaComment{--\ is-chain\ δ\ =\ ∀\ n\ →\ (δ\ n)\ ⊑\ (δ\ (suc\ n))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\<%
\\
%
\>[8]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaFourSendProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-send‵′\ :\ ∀\ n\ ρ\ →\ }\<%
\\
%
\>[8]\AgdaComment{--\ \ \ send‵′\ n\ ρ\ ⊑\ send‵′\ (suc\ n)\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-3}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{iter-is-chain}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{class}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
%
\newcommand{\LemmaFourLookupProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-lookup′\ :\ ∀\ n\ κ\ ρ\ →\ }\<%
\\
%
\>[8]\AgdaComment{--\ \ \ lookup′\ n\ κ\ ρ\ ⊑\ lookup′\ (suc\ n)\ κ\ ρ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{⊥-is-least}\<%
\\
%
\>[8]\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-2}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{gen}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\end{code}
}%
\begin{code}%
%
\>[8]\AgdaFunction{lemma-4-do′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\end{code}
%
\newcommand{\LemmaFourDoProof}{
\begin{code}%
%
\>[8]\AgdaComment{--\ lemma-4-do′\ :\ ∀\ n\ e\ ρ\ c\ κ\ →}\<%
\\
%
\>[8]\AgdaComment{--\ \ \ do′\ (suc\ n)\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)\ ⊑\ }\<%
\\
%
\>[8]\AgdaComment{--\ \ \ do′\ (suc\ (suc\ n))\ ⟦\ e\ ⟧\ ρ\ (child\ c\ κ)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lemma-4-do′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{begin-⊑}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{≡⊑⟨}}\AgdaSpace{}%
\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{⊑⟨}}%
\>[1985I]\AgdaBound{is-assumed-monotone-2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSymbol{)}\<%
\\
\>[1985I][@{}l@{\AgdaIndent{0}}]%
\>[15]\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[15]\AgdaSymbol{(}\AgdaFunction{lemma-4-send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{⊑⟨}}%
\>[2009I]\AgdaBound{is-assumed-monotone}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
\>[2009I][@{}l@{\AgdaIndent{0}}]%
\>[15]\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[15]\AgdaSymbol{(}\AgdaFunction{lemma-4-lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{eval⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{≡⊑⟨}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma-1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{do′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{child}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{∎-⊑}}\<%
\end{code}
}

\subsection{Remaining Results}

When Agda proofs of the remaining propositions and correctness theorem from CP89
have been developed, they are to be made available at
\url{https://github.com/pdmosses/jensfest-agda}.

\begin{code}%
%
\>[8]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaBound{Gᵍ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[12]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{isoᵍ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Gᵍ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↔}}\AgdaSpace{}%
\AgdaFunction{Dᵍ}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{lub}%
\>[20]\AgdaSymbol{:}%
\>[23]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Domain}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{δ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[10]\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Instance}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟨}}\AgdaSpace{}%
\AgdaBound{Behavior}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟩}}\<%
\\
%
\>[10]\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{lub}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send′}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[10]\AgdaFunction{proposition-1}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{proposition-2}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{proposition-3}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⊑}}\AgdaSpace{}%
\AgdaFunction{interpret}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\\
%
\>[10]\AgdaFunction{theorem-1}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[27]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{behave}\AgdaSpace{}%
\AgdaBound{ρ}\<%
\end{code}
\begin{code}[hide]%
%
\>[10]\AgdaFunction{proposition-1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{proposition-2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{proposition-3}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\\
%
\>[10]\AgdaFunction{theorem-1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\end{code}
